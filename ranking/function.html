<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>2023-2 UROP</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <style>
        body {
            font-family: 'Arial', sans-serif;
        }
        .navbar-brand, .nav-item {
            font-size: 20px;
            font-weight: bold;
        }
        .form-control, .form-label {
            font-weight: bold;
            font-size: 20px;
        }
        .bg-light {
            padding: 20px;
        }
        .in {
            text-indent: 30px;
        }
        .container {
            background-color: #ffffff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            margin-top: 20px;
            padding: 20px;
        }
        pre {
            background-color: #f4f4f4;
            padding: 10px 50px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        ul{
            list-style:none;
        }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: rgb(0,0,0);">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">UROP</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            ê°œë°œ ê°€ì´ë“œ
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">í™˜ê²½ì„¤ì •</a></li>
                            <li><a class="dropdown-item" href="#">í´ë¼ì´ì–¸íŠ¸</a></li>
                            <li><a class="dropdown-item" href="#">ì„œë²„</a></li>
                            <li><a class="dropdown-item" href="#">ì•Œê³ ë¦¬ì¦˜</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            ì•± ì„¤ëª…
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">ì•± ë¹Œë“œ ë°©ë²•</a></li>
                            <li><a class="dropdown-item" href="#">ì•± êµ¬ë™ ëª¨ìŠµ ì„¤ëª…</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="p-5 mb-4 bg-light rounded-3">
        <div class="container-fluid py-5">
            <h3 class="fw-bold">ğŸ“Œ&nbsp;&nbsp;RANKING ì£¼ìš” êµ¬ì„± ìš”ì†Œ ë° ê¸°ëŠ¥</h3>
            <br>
            <h6>â†’&nbsp;&nbsp;ì˜ˆì œ ì½”ë“œëŠ” Flutter í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°œë°œëœ Dart ì½”ë“œì…ë‹ˆë‹¤. </h6>
            <hr>

            <br>
            <p class="col-md-12 fs-5"><strong>1. íŒ¨í‚¤ì§€ import</strong></p>
            <p class="col-md-12 fs-6">ìš°ì„ , í˜ì´ì§€ êµ¬í˜„ì„ ìœ„í•´ í•„ìš”í•œ íŒ¨í‚¤ì§€ë“¤ì„ import í•©ë‹ˆë‹¤.</p>
            <p class="col-md-12 fs-6 in">1.1 Flutterì—ì„œ UIë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•œ ê¸°ë³¸ íŒ¨í‚¤ì§€ import</p>
            <p class="col-md-12 fs-6 in">1.2 ì„œë²„ì™€ í†µì‹ í•˜ê³ , ì„œë²„ì— http ìš”ì²­ì„ ë³´ë‚´ê¸° ìœ„í•œ íŒ¨í‚¤ì§€ import</p>
            <p class="col-md-12 fs-6 in">1.3 JSON ë°ì´í„°ë¥¼ ì¸ì½”ë”©í•˜ê±°ë‚˜ ë””ì½”ë”©í•˜ê¸° ìœ„í•œ íŒ¨í‚¤ì§€ import</p>
            <p class="col-md-12 fs-6 in">1.4 ë¡œì»¬ ì €ì¥ì†Œì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ê²€ìƒ‰í•˜ëŠ” ë° ì‚¬ìš©í•˜ê¸° ìœ„í•œ íŒ¨í‚¤ì§€ import</p>
            <br>
            <pre style="width: max-content;">
                <code class="dart" style="text-align: center;"><br>import 'package:flutter/material.dart';<br>import 'package:http/http.dart' as http;<br>import 'dart:convert';<br>import 'package:shared_preferences/shared_preferences.dart';</code>
            </pre>

            <br>
            <br>
            <p class="col-md-12 fs-5"><strong>2. UserRanking í´ë˜ìŠ¤</strong></p>
            <p class="col-md-12 fs-6 in">2.1 ì‚¬ìš©ì ë­í‚¹ ì •ë³´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í´ë˜ìŠ¤ë¡œ, ì„œë²„ì—ì„œ ë°›ì•„ì˜¤ëŠ” ì •ë³´ë“¤ì„ í‘œì‹œí•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
            <p class="col-md-12 fs-6 in">2.2 ë°ì´í„° ëª¨ë¸ì„ ì •ì˜í•˜ì—¬ ì„œë²„ë¡œë¶€í„° ë°›ì•„ì˜¨ ì‚¬ìš©ì ìˆœìœ„ ë°ì´í„°ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ë‹¤ë£° ìˆ˜ ìˆê²Œë” êµ¬ì¡°í™”í•˜ì˜€ìŠµë‹ˆë‹¤.</p>
            <p class="col-md-12 fs-6 in">2.2 required í‚¤ì›Œë“œë¥¼ í†µí•´ í•´ë‹¹ ì†ì„±ì´ ìƒì„±ìë¥¼ í†µí•´ ë°˜ë“œì‹œ ì œê³µë˜ê²Œë” êµ¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ì„œ ëˆ„ë½ëœ ë°ì´í„°ë‚˜ ë¶€ì ì ˆí•œ ë°ì´í„°ê°€ ë“¤ì–´ì˜¤ëŠ” ê²ƒì„ ë°©ì§€í•˜ê³ , íƒ€ì… ì•ˆì •ì„±ì„ í™•ë³´í•©ë‹ˆë‹¤.</p>
            <br>
            <pre>
                <code>
                  class UserRanking {
                    final int rank;
                    final String email;
                    final String playtime;
                  
                    UserRanking({
                      required this.rank,
                      required this.email,
                      required this.playtime,
                    });
                  }
                </code>
            </pre>

            <br>
            <br>
            <p class="col-md-12 fs-5"><strong>3. RankingPage í´ë˜ìŠ¤ (StatefulWidget)</strong></p>
            <p class="col-md-12 fs-6 in">3.1 ë­í‚¹ í˜ì´ì§€ë¥¼ ìœ„í•œ StatefulWidgetì…ë‹ˆë‹¤. í™”ë©´ì˜ ìƒíƒœê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤(ë­í‚¹ì´ ë°”ë€” ë•Œë§ˆë‹¤) í™”ë©´ì´ ë‹¤ì‹œ ê·¸ë ¤ì ¸ì•¼ í•˜ê¸° ë•Œë¬¸ì—, StatefulWidget ìœ„ì ¯ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.</p>
            <p class="col-md-12 fs-6 in">3.2 ì´ ìœ„ì ¯ì˜ ìƒíƒœëŠ” _RankingPageStateì—ì„œ ê´€ë¦¬ë©ë‹ˆë‹¤.</p>
            <br>
            <pre>
                <code>
                  class RankingPage extends StatefulWidget {
                    const RankingPage({Key? key}) : super(key: key);  // RankingPage í´ë˜ìŠ¤ì˜ ìƒì„±ì
                  
                    @override  // ë¶€ëª¨ í´ë˜ìŠ¤ì¸ StatefulWidgetì˜ ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œ
                    _RankingPageState createState() => _RankingPageState();
                  }
                </code>
            </pre>
            
            <br>
            <br>
            <p class="col-md-12 fs-5"><strong>4. _RankingPageState í´ë˜ìŠ¤ (ìƒíƒœ ê´€ë¦¬)</strong></p>
            <p class="col-md-12 fs-6 in">4.1 ë­í‚¹ í˜ì´ì§€ì˜ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤. ì‚¬ìš©ì ë­í‚¹ ëª©ë¡ì„ ì´ˆê¸°í™”í•˜ê³ , ìœ„ì ¯ì´ ì´ˆê¸°í™”ë  ë•Œ ì„œë²„ì—ì„œ ë­í‚¹ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.</p>
            <p class="col-md-12 fs-6 in">4.2 _RankingPageState í´ë˜ìŠ¤ëŠ” RankingPage ìœ„ì ¯ì˜ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ê¸° ë•Œë¬¸ì—, State<RankingPage>ë¥¼ ìƒì†í•©ë‹ˆë‹¤.</p>
            <p class="col-md-12 fs-6 in">4.3 ë­í‚¹ í˜ì´ì§€ì—ì„œ í‘œì‹œí•  ì‚¬ìš©ì ë­í‚¹ ë°ì´í„°ë¥¼ ë‹´ê¸° ìœ„í•œ ë¦¬ìŠ¤íŠ¸ë¥¼ ì„ ì–¸í•˜ê³  ì´ˆê¸°í™”í•©ë‹ˆë‹¤. ì²˜ìŒì—ëŠ” ë°ì´í„°ê°€ ì—†ìœ¼ë¯€ë¡œ ë¹ˆ ë¦¬ìŠ¤íŠ¸ë¡œ ì‹œì‘í•©ë‹ˆë‹¤.</p>
            <p class="col-md-12 fs-6 in">4.4 ìœ„ì ¯ì´ ì²˜ìŒìœ¼ë¡œ í™”ë©´ì— ë‚˜íƒ€ë‚  ë•Œ(initState ë©”ì„œë“œ), ì„œë²„ì—ì„œ ë­í‚¹ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>

            <br>
            <pre>
                <code>
                  class _RankingPageState extends State<RankingPage> {
                    List<UserRanking> userRankingList = [];  // ë­í‚¹ í˜ì´ì§€ì—ì„œ í‘œì‹œí•  ì‚¬ìš©ì ë­í‚¹ ë°ì´í„°ë¥¼ ë‹´ê¸° ìœ„í•œ ë¦¬ìŠ¤íŠ¸
                  
                    @override
                    void initState() {  // ìƒíƒœ ê°ì²´ê°€ ìƒì„±ëœ í›„, ìœ„ì ¯ì´ íŠ¸ë¦¬ì— ì¶”ê°€ë  ë•Œ í•œ ë²ˆ í˜¸ì¶œ. ì£¼ë¡œ ì´ˆê¸°í™” ì‘ì—…ì´ ì´ë£¨ì–´ì§.
                      super.initState();
                      // ìœ„ì ¯ì´ ì´ˆê¸°í™”ë  ë•Œ ì„œë²„ì—ì„œ ë­í‚¹ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ëŠ” í•¨ìˆ˜ í˜¸ì¶œ
                      userRanking();
                    }
                </code>
            </pre>

            <br>
            <br>
            <p class="col-md-12 fs-5"><strong>5. userRanking í•¨ìˆ˜ (ë­í‚¹ ë°ì´í„° ë°›ì•„ì˜¤ê¸°)</strong></p>
            <p class="col-md-12 fs-6 in">5.1 ì„œë²„ì—ì„œ ë­í‚¹ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜ì…ë‹ˆë‹¤.</p>
            <br>
            <pre>
                <code>
                  Future<void> userRanking() async {
                    try {
                      final response = await http.post(
                        Uri.parse('http://ec2-54-172-150-42.compute-1.amazonaws.com:8080/users/ranking_all'),
                        headers: {
                          'Content-Type': 'application/json',
                        },
                      );

                      print('ì„œë²„ ì‘ë‹µ: ${response.body}');

                      if (response.statusCode == 200) {
                        final Map<String, dynamic> responseData = jsonDecode(response.body);  // ì„œë²„ì—ì„œ ë°›ì€ ì‘ë‹µ ë³¸ë¬¸ì„ JSON ë””ì½”ë”©í•˜ì—¬ responseDataì— ì €ì¥
                        final List<dynamic> topUsers = responseData['top_users'];
                        final List<UserRanking> rankingData = parseRankingData(topUsers);
                        updateRankingList(rankingData);
                        print('ë°ì´í„° ë°›ì•„ì˜¤ê¸° ì„±ê³µ');
                      } else {
                        print('ë°ì´í„° ë°›ì•„ì˜¤ê¸° ì‹¤íŒ¨, statusCode: ${response.statusCode}');
                      }
                    } catch (error) {
                      print('ì—ëŸ¬ ë°œìƒ: $error');
                    }
                }
                </code>
            </pre>
            <br>
            <p class="col-md-12 fs-5"><strong>6. parseRankingData ë©”ì„œë“œ (ë­í‚¹ ë°ì´í„° íŒŒì‹±)</strong></p>
            <p class="col-md-12 fs-6">6.1 ì„œë²„ì—ì„œ ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ ê°€ê³µí•˜ì—¬ UserRanking ê°ì²´ì˜ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p>
            <p class="col-md-12 fs-6">6.2 ê° ì‚¬ìš©ìì— ëŒ€í•œ ì •ë³´(ì´ë©”ì¼ ë° í”Œë ˆì´íƒ€ì„)ì™€ ìˆœìœ„(rank)ë¥¼ ë¶€ì—¬í•˜ê³ , ì´ë¥¼ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€í•˜ì—¬ ë°˜í™˜í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œ map í•¨ìˆ˜ëŠ” ë¦¬ìŠ¤íŠ¸ì˜ ê° ìš”ì†Œì— ëŒ€í•´ ì£¼ì–´ì§„ í•¨ìˆ˜ë¥¼ ì ìš©í•˜ê³ , toList í•¨ìˆ˜ëŠ” ê·¸ ê²°ê³¼ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p>
            <br>
            <pre>
                <code>
                  List<UserRanking> parseRankingData(List<dynamic> data) {
                    int rank = 1;
                    return data.map((user) {
                      final UserRanking my = UserRanking(
                        rank: rank,
                        email: user['email'],
                        playtime: user['duration'],
                      );
                      rank++;
                      return my;
                    }).toList();
                  }
                </code>
            </pre>

            <br>
            <br>
            <p class="col-md-12 fs-5"><strong>7. updateRankingList ë©”ì„œë“œ (ë°ì´í„° ì—…ë°ì´íŠ¸)</strong></p>
            <p class="col-md-12 fs-6 in">7.1 ì„œë²„ì—ì„œ ë­í‚¹ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜ì…ë‹ˆë‹¤. ê°€ê³µëœ rankingDataë¥¼ ì‚¬ìš©í•˜ì—¬ userRankingListë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.</p>
            <p class="col-md-12 fs-6 in">7.2 setState í•¨ìˆ˜ëŠ” ìƒíƒœë¥¼ ë³€ê²½í•  ë•Œ ì‚¬ìš©ë˜ë©°, ì—¬ê¸°ì„œëŠ” ìƒˆë¡œìš´ ë­í‚¹ ë°ì´í„°ë¡œ UIë¥¼ ê°±ì‹ í•©ë‹ˆë‹¤.</p>
            <br>
            <pre>
                <code>
                  void updateRankingList(List<UserRanking> rankingData) {
                    setState(() {
                      userRankingList = rankingData;
                    });
                  }
                </code>
            </pre>

            <br>
            <br>
            <p class="col-md-12 fs-5"><strong>8. build ë©”ì„œë“œ (í™”ë©´ ë Œë”ë§)</strong></p>
            <p class="col-md-12 fs-6 in">8.1 í™”ë©´ì„ ë Œë”ë§í•˜ëŠ” ë©”ì„œë“œì…ë‹ˆë‹¤.</p>
            <p class="col-md-12 fs-6 in">8.2 í•´ë‹¹ ì½”ë“œì—ì„œëŠ” ë­í‚¹ ì •ë³´ë¥¼ DataTableì„ ì‚¬ìš©í•˜ì—¬ í‘œì‹œí•©ë‹ˆë‹¤.</p>
            <br>
            <pre>
                <code>
                  @override
                  Widget build(BuildContext context) {
                    return Scaffold(
                      // appBar: AppBar(
                      //   title: const Text('User Ranking'),
                      // ),
                      body: Center(
                        child: Column(
                          mainAxisAlignment: MainAxisAlignment.center,
                          children: [
                            const Text(
                              'ìœ ì € ìˆœìœ„',
                              style: TextStyle(
                                fontSize: 17,
                                fontWeight: FontWeight.bold,
                              ),
                            ),
                            const SizedBox(height: 0),
                            DataTable(
                              // ë­í‚¹ (í‘œ í˜•íƒœ)
                              columns: const [
                                DataColumn(label: Text('ìˆœìœ„')),
                                DataColumn(label: Text('ì´ë©”ì¼')),
                                DataColumn(label: Text('ê±¸ë¦° ì‹œê°„')),
                              ],
                              rows: userRankingList.map((user) {
                                return DataRow(
                                  cells: [
                                    DataCell(Center(child: Text(user.rank.toString()))),
                                    DataCell((Center(child: Text(user.email)))),
                                    DataCell((Center(child: Text(user.playtime)))),
                                  ],
                                );
                              }).toList(),
                            ),
                          ],
                        ),
                      ),
                    );
                  }
                }
                </code>
            </pre>

            
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
</body>
</html>
